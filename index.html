<!-- === Shims / Helpers en tout premier === -->
<script>
  // Helper global
  window.$ = window.$ || (id => document.getElementById(id));

  // Garde-fous : si certaines fonctions ne sont pas encore dÃ©finies,
  // on Ã©vite le crash en crÃ©ant des no-ops (fonctions vides).
  [
    "initGolfSelect","showResumeOrNewModal","renderHole",
    "initTraining","renderHistory","injectSocialUI",
    "showCoachIA","hideCoachIA","showCoachToast"
  ].forEach(fn => { if (typeof window[fn] !== "function") window[fn] = function(){}; });

  // Log des erreurs JS pour tâ€™aider Ã  diagnostiquer
  window.addEventListener("error", (e) => {
    console.error("ðŸ”¥ JS Error:", e.message, e.filename+":"+e.lineno+":"+e.colno);
  });
</script>

<!-- === Ordre: coach dâ€™abord, puis features, puis main (qui fait le wiring) === -->
<script src="coachIA.js"></script>
<script src="play.js"></script>
<script src="training.js"></script>
<script src="history.js"></script>
<script src="objectives.js"></script>
<script src="social.js"></script>
<script src="licence.js"></script>

<!-- === Main Ã  la fin (attend que tout le reste soit dÃ©fini) === -->
<script>
  document.addEventListener("DOMContentLoaded", () => {
    console.log("âœ… Boot MVP");

    // Initialiser le coach (sans ouvrir automatiquement)
    if (typeof initCoachIA === "function") initCoachIA();

    // Raccourcis footer (si prÃ©sents dans ta page)
    const map = {
      play: $("play-btn"),
      training: $("training-btn"),
      history: $("history-btn"),
      friends: $("friends-btn")
    };

    Object.entries(map).forEach(([name, btn]) => {
      if (!btn) return;
      btn.addEventListener("click", () => {
        // Visuel menu actif
        document.querySelectorAll("nav button").forEach(b => b.classList.remove("active"));
        btn.classList.add("active");

        // Actions
        if (name === "play") {
          // Ouvre la modale Reprendre / Nouvelle partie si dispo
          if (typeof showResumeOrNewModal === "function") showResumeOrNewModal();
          // Sinon fallback : afficher la liste des golfs
          if (typeof initGolfSelect === "function") initGolfSelect();
        }
        if (name === "training" && typeof initTraining === "function") initTraining();
        if (name === "history" && typeof renderHistory === "function") renderHistory();
        if (name === "friends" && typeof injectSocialUI === "function") injectSocialUI();

        // Ping coach (facultatif)
        if (typeof showCoachIA === "function") showCoachIA(`ðŸŸ¢ ${name} activÃ©`);
      });
    });
  });
</script>

